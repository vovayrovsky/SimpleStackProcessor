#include "board.h"

#include <stdio.h>

#define STD_FIN "input.txt"
#define VERS "v0.1"

int main()
    {
    printf ("SSP version: " VERS "\n"
            "Load file: %s\n", STD_FIN);

    FILE* fin = fopen (STD_FIN, "rt");
    assert (fin);

    Board brd;

    uint16_t dump_len = 0;
    char buf = 0;
    fscanf (fin, "%c%c", &dump_len, &buf);

    dump_len = dum
    if (dump_len == 0) return -1;

    printf ("Program len: %d\nLoading program\n", dump_len);
    for (uint16_t i = 0; i < dump_len; i++)
        fscanf (fin, "%hx", &(brd.store[i]));

    fclose (fin);

    printf ("\nInitial memory map:\n");
    for (uint16_t i = 0; i < dump_len; i++)
        {
        printf ("%x\t", brd.store[i]);
        if (i % 8 == 7) printf ("\n");
        }

    printf ("\nStarting system\n");
    printf ("%d\n", getch());
    brd.Start();

    getch();
    return 0;
    }
